jQuery.fn.scrollTo=function(t){return $(this).scrollTop($(this).scrollTop()-$(this).offset().top+$(t).offset().top-45),this},$(function(){$(".ui.pointing.dropdown.link.item").dropdown()});var PHONE_VALIDATOR=/^[6-9]\d{9}$/;function toggleFilterView(){$("#invoiceFilters").transition({animation:"slide down"})}function initLogout(){$(".logout-modal").modal("show")}function initLogoutResponsive(){$(".dimmed").click(),setTimeout(initLogout,500)}document.addEventListener("visibilitychange",function(){});var BASE_URL=window.location.origin+"/",app=angular.module("app",["ui.router","ngAnimate","toastr","angularUtils.directives.dirPagination","selectize"]),timeInMillsDate=(app.factory("dataFactory",["$http","toastr",function(r,e){var t={toastSuccess:function(t){e.success(t,"")},toastError:function(t){e.error(t,"")},toastInfo:function(t){e.info(t,"")},get:function(t){return r.get(BASE_URL+t).then(function(t){return t.data})},post:function(t,e){return r.post(BASE_URL+t,e).then(function(t){return t.data})},put:function(t,e){return r.put(BASE_URL+t,e).then(function(t){return t.data})},delete:function(t){return r.delete(BASE_URL+t).then(function(t){return t.data})}};return t}]),app.run(["$rootScope",function(t){t.BASE_URL=BASE_URL}]),app.config(["toastrConfig",function(t){angular.extend(t,{autoDismiss:!1,closeButton:!0,containerId:"toast-container",maxOpened:0,newestOnTop:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,preventOpenDuplicates:!1,target:"body"})}]),app.config(["$locationProvider",function(t){t.hashPrefix("")}]),app.config(["paginationTemplateProvider",function(t){t.setPath("/templates/dirPagination.tpl.html")}]),app.filter("isoDateFormat",function(){return function(t,e){try{return e=e||"DD-MM-YYYY HH:mm",moment(t).format(e)}catch(t){return""}}}),new Date),currImageId=(app.filter("timeInMills",function(){return function(t){return t?(timeInMillsDate.setTime(14880474e5+t),moment(timeInMillsDate).format("hh:mm a")):"n/a"}}),app.config(["$provide",function(t){t.decorator("$state",["$delegate","$rootScope",function(n,t){return t.$on("$stateChangeStart",function(t,e,r){n.next=e,n.toParams=r}),n}])}]),""),currUploadedFile=null;function processFileForUpload(t){try{var r=(t.target.files||t.dataTransfer.files||t.originalEvent.dataTransfer.files)[0];if(r){var e=(e=r.name.toUpperCase().split("."))[e.length-1];if(524288<r.size){if(!(0<=["JPG","JPEG"].indexOf(e)))return $("#proxy-err-msg").attr("data-msg","Please use a file smaller than 512kb"),void $("#proxy-err-msg").click();new Compressor(r,{quality:.7,maxWidth:1920,maxHeight:1080,success:function(t){var e=new File([t],r.name);$("#img-"+currImageId).attr("src",URL.createObjectURL(t)),currUploadedFile=e},error:function(t){$("#proxy-err-msg").attr("data-msg","Failed to process this file"),$("#proxy-err-msg").click()}})}var n=new FileReader;n.onload=function(t){$("#img-"+currImageId).attr("src",t.target.result),currUploadedFile=r},n.readAsDataURL(r),document.getElementById("invoice-thumbnail-upload").value=""}}catch(t){}}function ExcelDateToJSDate(t){var e=Math.floor(t-25569),e=new Date(1e3*(86400*e)),t=t-Math.floor(t)+1e-7,t=Math.floor(86400*t),r=t%60,n=(t-=r,Math.floor(t/3600)),t=Math.floor(t/60)%60;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),n,t,r)}function getUrlVars(){for(var t,e=[],r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<r.length;n++)t=r[n].split("="),e.push(t[0]),e[t[0]]=t[1];return e}function toTitleCase(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function isValidDate(t){return t instanceof Date&&!isNaN(t)}Date.prototype.getTimezoneOffsetMills=function(){return 60*this.getTimezoneOffset()*1e3},Date.prototype.getUTCTime=function(){return this.getTime()+this.getTimezoneOffsetMills()},Date.prototype.setUTCTime=function(t){t-=this.getTimezoneOffsetMills(),this.setTime(t)},Date.prototype.daysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},Date.prototype.addDays=function(t){this.setDate(this.getDate()+t)},Date.prototype.print=function(){var t=this.getDate(),e=this.getMonth()+1;return(t=t<10?"0"+t:t)+"/"+(e=e<10?"0"+e:e)+"/"+this.getFullYear()},Date.prototype.parse=function(t){this.setDate(1);try{var e=(t=t.trim()).split("/");if(4!=e[2].length)throw{};if(isNaN(this.setFullYear(Number(e[2]))))throw{};if(isNaN(this.setMonth(Number(e[1])-1)))throw{};if(isNaN(this.setDate(Number(e[0]))))throw{};return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),!0}catch(t){return!1}},Date.prototype.parseDayEnd=function(t){this.setDate(1);try{var e=(t=t.trim()).split("/");if(4!=e[2].length)throw{};if(isNaN(this.setFullYear(Number(e[2]))))throw{};if(isNaN(this.setMonth(Number(e[1])-1)))throw{};if(isNaN(this.setDate(Number(e[0]))))throw{};return this.setHours(23),this.setMinutes(59),this.setSeconds(59),this.setMilliseconds(999),!0}catch(t){return!1}},Date.prototype.getWeek=function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil(((this-t)/864e5+t.getDay()+1)/7)};var getFlattenedArray=function(t,e){function l(o,a,i){i=i||[];try{Object.keys(o).forEach(function(t){var e=a?a+"_"+t:t;if(o[t])if(Array.isArray(o[t]))for(var r=0,n=o[t].length;r<n;r++)0<r&&(s.push({}),u++),"object"!=typeof o[t][r]?(i.push(e),s[u][e]=o[t]):l(o[t][r],e,i);else"object"==typeof o[t]?l(o[t],e,i):(i.push(e),s[u][e]=o[t]);else i.push(e),s[u][e]=""})}catch(t){}}for(var r=[],s=[],u=0,n=[],o=0,a=t.length;o<a;o++){var i=t[o];if(s.push({}),l(i,"",r),r=_.uniq(r),1<s.length){y=m=g=p=d=D=h=c=void 0;for(var f=s,c={},h=0,d=0,p=0,g=null,m=null,y=null,h=0,D=f.length;h<D;h++)for(g=f[h],d=0,p=r.length;d<p;d++)null!=(y=g[m=r[d]])?c[m]=y:c[m]&&(g[m]=c[m]);for(c={},h=f.length-1;0<=h;h--)for(g=f[h],d=0,p=r.length;d<p;d++)null!=(y=g[m=r[d]])?c[m]=y:c[m]&&(g[m]=c[m])}n=n.concat(s),u=0,s=[]}return r.sort(),e||(n=_.uniqWith(n,_.isEqual)),{keys:r,values:n}},__round=function(t){return t?_.round(t,3):0};function datenum(t,e){e&&(t+=1462);e=-1*t.getTimezoneOffsetMills(),t=Date.parse(t);return((t+=e)-new Date(Date.UTC(1899,11,30)))/864e5}function sheet_from_array_of_arrays(t,e){for(var r={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=t.length;++o)for(var a=0;a!=t[o].length;++a){n.s.r>o&&(n.s.r=o),n.s.c>a&&(n.s.c=a),n.e.r<o&&(n.e.r=o),n.e.c<a&&(n.e.c=a);var i,l={v:t[o][a]};null!=l.v&&(i=XLSX.utils.encode_cell({c:a,r:o}),"number"==typeof l.v?l.t="n":"boolean"==typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=XLSX.SSF._table[14],l.v=datenum(l.v)):l.t="s",r[i]=l)}return n.s.c<1e7&&(r["!ref"]=XLSX.utils.encode_range(n)),r}function Workbook(){if(!(this instanceof Workbook))return new Workbook;this.SheetNames=[],this.Sheets={}}function s2ab(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=255&t.charCodeAt(n);return e}function date2String(t){var e=t.getDate(),r=(e<10&&(e="0"+e),t.getMonth()+1);return e+"/"+(r=r<10?"0"+r:r)+"/"+t.getFullYear()}var offset=(new Date).getTimezoneOffsetMills();function excelDateToJSDate(t){var e;return"string"==typeof t||t instanceof String?(e=moment(t,"DD/MM/YYYY")).isValid?e.toDate():null:(e=Number(t),isNaN(e)?null:new Date(Math.round(86400*(e-25569)*1e3+offset)))}const excelColumnNames=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ","BA","BB","BC","BD","BE","BF","BG","BH","BI","BJ","BK","BL","BM","BN","BO","BP","BQ","BR","BS","BT","BU","BV","BW","BX","BY","BZ","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP","CQ","CR","CS","CT","CU","CV","CW","CX","CY","CZ","DA","DB","DC","DD","DE","DF","DG","DH","DI","DJ","DK","DL","DM","DN","DO","DP","DQ","DR","DS","DT","DU","DV","DW","DX","DY","DZ"],headerColorStyle={rgb:"FFD3D3D3"},blackColorStyle={rgb:"FF000000"},errorColorStyle={rgb:"FFF55B5B"},borderLineStyle={style:"thin",color:blackColorStyle},borderStyle={top:borderLineStyle,right:borderLineStyle,bottom:borderLineStyle,left:borderLineStyle},headerStyle={alignment:{wrapText:1,horizontal:"center"},fill:{fgColor:headerColorStyle},font:{sz:10},border:borderStyle},defaultStyle={alignment:{horizontal:"left"},font:{sz:10},border:borderStyle},defaultStyleRight={alignment:{wrapText:1,horizontal:"right"},font:{sz:10},border:borderStyle},dateStyleWithBorder={alignment:{wrapText:!0,horizontal:"left"},font:{sz:10},border:borderStyle,numFmt:"dd/mm/yyyy"},displayString=function(t){return t?{v:t="object"==typeof t&&null!==t||Array.isArray(t)?t.toString():""+t,t:"s",s:defaultStyle}:{v:"",t:"s",s:defaultStyle}},displayInt=function(t,e){return null==t||0==t&&e||(t=Number(t),isNaN(t))?{v:"",t:"s",s:defaultStyle}:{v:t,t:"n",s:defaultStyleRight}},displayDate=function(t){return t?t instanceof Date&&!isNaN(t)?{v:t=new Date(t.getTime()+198e5),t:"d",s:dateStyleWithBorder}:isNaN(t)?{v:"",t:"s",s:defaultStyle}:((t=new Date(Number(t))).setTime(t.getTime()+198e5),{v:t,t:"d",s:dateStyleWithBorder}):{v:"",t:"s",s:defaultStyle}},displayBoolean=function(t){return null==t?{v:"",t:"s",s:defaultStyle}:1!=t?{v:"False",t:"s",s:defaultStyle}:{v:"True",t:"s",s:defaultStyle}},getDefaultWorkBook=function(a,i){try{let o=1;var t={SheetNames:[],Sheets:{}},l={},e=i.length;for(let t=0,e=i.length;t<e;t++)l[excelColumnNames[t]+o]={v:i[t].display,s:headerStyle,t:"s"};for(let n=0,t=a.length;n<t;n++){o++;for(let r=0,t=i.length;r<t;r++){let t=a[n][i[r].key],e=((t=null!=t&&null!=t?t:{val:t}).hasOwnProperty("val")||(t={val:t}),null);"s"==i[r].type?e=displayString(t.val):"n"==i[r].type?e=displayInt(t.val):"b"==i[r].type?e=displayBoolean(t.val):"d"==i[r].type&&(e=displayDate(t.val)),t.error&&(e.s=JSON.parse(JSON.stringify(e.s)),e.s.fill={fgColor:errorColorStyle},e.s.font.color={rgb:"FFFFE3E3"}),l[excelColumnNames[r]+o]=e}}return l["!ref"]="A1:"+excelColumnNames[e]+(o+1),t.SheetNames.push("main"),t.Sheets.main=l,{status:!0,doc:t}}catch(t){return{status:!1}}};