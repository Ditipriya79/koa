function updateNumber(){$.ajax({type:"POST",url:"/random.json",data:{foo:"bar"},success:function(e){$("#randomStatVal").html(e.number)},dataType:"json"})}let uploadedFile=null;function processFileForUpload(e){try{var a=(e.target.files||e.dataTransfer.files||e.originalEvent.dataTransfer.files)[0];if(a)if(/\.(xls|xlsx|ods)$/i.test(a.name)){if($(".file-upload-tab .parsley-required").html(""),536870912<a.size)return void $(".file-upload-tab .parsley-required").html("Please use a file smaller than 512kB");$(".file-upload-tab .parsley-required").html(""),$("#holder p label").hide(),$("#holder p a").html(a.name),$("#holder p a").show(),$("#submit_create_brand_bulk").removeClass("disabled"),$("#reset_create_brand_bulk").removeClass("disabled"),uploadedFile=a,document.getElementById("file_for_upload").value=""}else $(".file-upload-tab .parsley-required").html("Only <i>xls, xlsx, ods<i/> files are allowed.")}catch(e){}}const ISODate=function(e){return new Date(e)},mockData=[{slno:1,name:"AANAND",code:"MRK0001",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"RC-861",mdmCode:"M0001"},{slno:2,name:"AANCHAL TEA",code:"MRK0002",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0002"},{slno:3,name:"AAROHI",code:"MRK0003",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M3091",teaBoardRegNo:"RC-2030"},{slno:4,name:"AASHVI (GOLD)",code:"MRK0004",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"RC-1696",mdmCode:"M0004"},{slno:5,name:"AASTHA",code:"MRK0005",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0005",teaBoardRegNo:"RC-1934"},{slno:6,name:"ABALI ORGANIC",code:"MRK0006",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M2854"},{slno:7,name:"ABHAY GOLD",code:"MRK0007",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"RC-2036",mdmCode:"M0007"},{slno:8,name:"ABHILEXTEA",code:"MRK0008",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"NA",mdmCode:"M0008"},{slno:9,name:"ABHINAV",code:"MRK0009",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0009"},{slno:10,name:"ABHISHEK",code:"MRK0010",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M2855"},{slno:11,name:"ABHISHEKTEA",code:"MRK0011",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M2855"},{slno:12,name:"ABHOYJAN",code:"MRK0012",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0010"},{slno:13,name:"ACHABAM",code:"MRK0013",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"NA",mdmCode:"M0011"},{slno:14,name:"ACHAPARA",code:"MRK0014",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0013"},{slno:15,name:"ADARSH",code:"MRK0015",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0014",teaBoardRegNo:"RC-1470"},{slno:16,name:"ADARSHGOLD",code:"MRK0016",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0015"},{slno:17,name:"ADDABARIE",code:"MRK0017",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"NA",mdmCode:"M0016"},{slno:18,name:"ADDABARIEHIGHGROWN",code:"MRK0018",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0017"},{slno:19,name:"ADHIKARY",code:"MRK0019",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0018"},{slno:20,name:"AENAKHALL",code:"MRK0020",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0020"},{slno:21,name:"AENAKHALLCLONAL",code:"MRK0021",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0021"},{slno:22,name:"AENAKHALLPREMIUM",code:"MRK0022",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0022"},{slno:23,name:"AGNIGARH",code:"MRK0023",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0024"},{slno:24,name:"AGNIGARHCLONAL",code:"MRK0024",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0025"},{slno:25,name:"AGNIGARHORGANIC",code:"MRK0025",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0026"},{slno:26,name:"AGOMONI",code:"MRK0026",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0027",teaBoardRegNo:"RC-2044"},{slno:27,name:"AGRATULEE",code:"MRK0027",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0028"},{slno:28,name:"AHEDGOLD",code:"MRK0028",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0029"},{slno:29,name:"AHINABARI",code:"MRK0029",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0030"},{slno:30,name:"AHOMBARI",code:"MRK0030",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0031"},{slno:31,name:"AIBHEEL",code:"MRK0031",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"RC-932",mdmCode:"M0032"},{slno:32,name:"AIDAUPUKHURI",code:"MRK0032",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0033"},{slno:33,name:"AIDEOBARIE",code:"MRK0033",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0035"},{slno:34,name:"AIDEOBARIPREMIUM",code:"MRK0034",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0034"},{slno:35,name:"AISHWINI",code:"MRK0035",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0037"},{slno:36,name:"AKIYA",code:"MRK0036",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0038"},{slno:37,name:"AKIYACLONAL",code:"MRK0037",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0039"},{slno:38,name:"AKSHAYPUR",code:"MRK0038",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0044"},{slno:39,name:"ALIF",code:"MRK0039",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0046"},{slno:40,name:"ALIMUR",code:"MRK0040",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0047"},{slno:41,name:"ALIMURNATURAL",code:"MRK0041",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0048"},{slno:42,name:"ALITEA",code:"MRK0042",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0045"},{slno:43,name:"ALLEY BUSTEE",code:"MRK0043",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0050",teaBoardRegNo:"RC-943"},{slno:44,name:"ALOKEPUR",code:"MRK0044",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0051"},{slno:45,name:"ALOKPUR",code:"MRK0045",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0052"},{slno:46,name:"AMALAAN",code:"MRK0046",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0054"},{slno:47,name:"AMALBARI",code:"MRK0047",organic:!1,teaBoardRegNo:"RC-10009",createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0055"},{slno:48,name:"AMARNATHTEA",code:"MRK0048",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),teaBoardRegNo:"NA",mdmCode:"M0056"},{slno:49,name:"AMARPUR",code:"MRK0049",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0057",teaBoardRegNo:"RC-1922"},{slno:50,name:"AMARPUR GOLD",code:"MRK0050",organic:!1,createdAt:ISODate("2020-09-29T18:11:17.923Z"),mdmCode:"M0058",teaBoardRegNo:"RC-1922"}];function validateData(o){let d=!0;o||(o=mockData,d=!1);var t=[],r=(t.push({display:"Sl No",key:"slno",excelKey:"Sl No",type:"n",required:!0}),t.push({display:"Name",key:"name",excelKey:"Name",type:"s",required:!0}),t.push({display:"Code",key:"code",excelKey:"Code",type:"s",required:!0}),t.push({display:"Mdm",key:"mdmCode",excelKey:"Mdm",type:"s",required:!0}),t.push({display:"Organic",key:"organic",excelKey:"Organic",type:"b"}),t.push({display:"Reg No",key:"teaBoardRegNo",excelKey:"Reg No",type:"s",required:!0}),t.push({display:"Created At",key:"createdAt",excelKey:"Created At",type:"d",required:!0}),t.push({display:"Status",key:"status",excelKey:"Status",type:"s"}),t.push({display:"Msg",key:"msg",excelKey:"Msg",type:"s"}),[]);for(let e=0,a=o.length;e<a;e++){var n=o[e],l={},c=[];for(let o=0,e=t.length;o<e;o++){var m=t[o];let e=n[m.excelKey]||n[m.key],a=e=null!=(e=null!=(e=null!=(e=e&&"d"==m.type&&d?excelDateToJSDate(e):e)&&"b"==m.type?"TRUE"==(""+e).trim().toUpperCase():e)&&"s"==m.type?(""+e).trim().toUpperCase():e)&&"n"==m.type&&(e=Number(e),isNaN(e))?null:e;!e&&m.required&&(a={val:e,error:!0},c.push(`'${m.display}' is required.`)),l[m.key]=a}0==c.length?l.status="OK":(l.status="NOT OK",l.msg=c.join(", ")),r.push(l)}var e=getDefaultWorkBook(r,t);e.status&&(e=XLSX.write(e.doc,{bookType:"xlsx",bookSST:!0,type:"binary"}),saveAs(new Blob([s2ab(e)],{type:"application/octet-stream"}),"output_"+(new Date).getTime()+".xlsx"))}function submitBulk(){var e;uploadedFile&&((e=new FileReader).onload=function(e){var e=e.target.result,e=XLSX.read(e,{type:"binary"}),a=e.SheetNames[0],e=e.Sheets[a],a=XLSX.utils.sheet_to_json(e,{raw:!0});console.log(a),validateData(a)},e.readAsBinaryString(uploadedFile))}function clearBulk(){$(".file-upload-tab .parsley-required").html(""),$("#holder p label").show(),$("#holder p a").html(""),$("#holder p a").hide(),$("#submit_create_brand_bulk").addClass("disabled"),$("#reset_create_brand_bulk").addClass("disabled"),uploadedFile=null}var holder=document.getElementById("holder");holder.ondragover=function(){return $(this).addClass("div_drag_hover"),!1},holder.ondragend=function(){return $(this).removeClass("div_drag_hover"),!1},holder.ondrop=function(e){$(this).removeClass("div_drag_hover"),e.preventDefault(),processFileForUpload(e)};